id: "public.tts-api"
type: "APIS"
summary: "æ–‡æœ¬è½¬è¯­éŸ³ï¼ˆTTSï¼‰æœåŠ¡ï¼Œæ”¯æŒæœ¬åœ°å‚è€ƒéŸ³è‰²æˆ–æœåŠ¡å™¨éŸ³è‰²ã€‚"
description: |
  é€šè¿‡å…¬å¼€TTS APIï¼Œå¯ä»¥å°†ä»»æ„æ–‡æœ¬ç”Ÿæˆè¯­éŸ³éŸ³é¢‘ã€‚æ”¯æŒå‚è€ƒéŸ³é¢‘çš„éŸ³è‰²æ¨¡ä»¿æˆ–é€‰æ‹©å·²æœ‰æœåŠ¡å™¨éŸ³è‰²ã€‚
  æ”¯æŒ WAV/MP3 ç­‰éŸ³é¢‘æ ¼å¼ï¼Œå¹¶å¯æ§åˆ¶ç”Ÿæˆé•¿åº¦ã€éšæœºæ€§å’Œé‡å¤æƒ©ç½šç­‰å‚æ•°ã€‚

  ä¸»è¦åŠŸèƒ½ï¼š
  - æ–‡æœ¬è½¬è¯­éŸ³ç”Ÿæˆ
  - æ”¯æŒæœ¬åœ°å‚è€ƒéŸ³è‰²æ–‡ä»¶
  - å¯é€‰æ‹©æœåŠ¡å™¨å·²æœ‰éŸ³è‰²
  - æ”¯æŒæ§åˆ¶ç”Ÿæˆå‚æ•°ï¼šé•¿åº¦ã€æ¸©åº¦ã€é‡å¤æƒ©ç½šã€top_p
  - æ”¯æŒæµå¼æˆ–éæµå¼ç”Ÿæˆ

examples:      
  - title: "fastapi - ç”ŸæˆPPTå¹¶å¯¼å‡º"
    content: |
      import requests

      # æ­¥éª¤1ï¼šç”Ÿæˆæ¼”ç¤ºæ–‡ç¨¿
      generate_url = "http://192.168.1.218:4999/api/v1/ppt/presentation/generate"
      generate_data = {
          "prompt": "Introduction to Machine Learning",
          "n_slides": 5,  # æ”¹ä¸ºæ•´æ•°ç±»å‹
          "language": "English",
          "layout": "general",
          "export_as": "pptx"
      }

      # å‘é€ç”Ÿæˆè¯·æ±‚
      generate_response = requests.post(generate_url, data=generate_data)

      if generate_response.status_code != 200:
          print(f"ç”Ÿæˆå¤±è´¥: {generate_response.status_code}")
          print(generate_response.json())
          exit()

      generate_result = generate_response.json()
      print("ç”Ÿæˆç»“æœ:", generate_result)

      # è·å–è¿”å›çš„presentation_id
      presentation_id = generate_result['presentation_id']

      # æ­¥éª¤2ï¼šå¯¼å‡ºPPTXæ–‡ä»¶
      export_url = "http://192.168.1.218:4999/api/v1/ppt/presentation/export/pptx"
      export_headers = {'Content-Type': 'application/json'}

      # æ„å»ºå¯¼å‡ºè¯·æ±‚ä½“
      export_data = {
          "name": "MachineLearning_Presentation",
          "slides": [],  # å®é™…ä½¿ç”¨ä¸­éœ€è¦å¡«å……å¹»ç¯ç‰‡æ•°æ®
          "shapes": []   # å®é™…ä½¿ç”¨ä¸­éœ€è¦å¡«å……å½¢çŠ¶æ•°æ®
      }

      export_response = requests.post(
          export_url,
          json=export_data,
          headers=export_headers
      )

      if export_response.status_code != 200:
          print(f"å¯¼å‡ºå¤±è´¥: {export_response.status_code}")
          print(export_response.json())
          exit()

      # ä¿å­˜PPTXæ–‡ä»¶
      output_filename = "machine_learning.pptx"
      with open(output_filename, 'wb') as f:
          f.write(export_response.content)

      print(f"PPTXæ–‡ä»¶å·²ä¿å­˜ä¸º: {output_filename}")
      
  - title: "fastmcp-pptç”Ÿæˆå¯¼å‡º"
    content: |
      """
      ä¼˜åŒ–åçš„MCPå®Œæ•´å·¥ä½œæµç¨‹æµ‹è¯•
      ä¿®å¤æ¼”ç¤ºæ–‡ç¨¿IDè·å–é—®é¢˜ï¼Œç¡®ä¿å¯¼å‡ºæµç¨‹å®Œæ•´æ‰§è¡Œ
      """

      import asyncio
      import os
      import aiohttp
      from fastmcp import Client
      from datetime import datetime

      async def test_mcp_fixed_workflow():
          """æµ‹è¯•ä¿®å¤åçš„MCPå®Œæ•´å·¥ä½œæµç¨‹"""
          print("ğŸ”§ æµ‹è¯•MCPä¿®å¤åçš„å·¥ä½œæµç¨‹")
          print("=" * 50)
          
          session_id = f"mcp_fix_test_{datetime.now().strftime('%Y%m%d_%H%M%S')}"
          
          try:
              async with Client("http://192.168.1.218:4999/mcp") as client:
                  print("âœ… è¿æ¥åˆ°MCPæœåŠ¡å™¨æˆåŠŸ")
                  
                  # æ­¥éª¤1: å¼€å§‹æ¼”ç¤ºæ–‡ç¨¿
                  print("\nğŸ“ æ­¥éª¤1: å¼€å§‹åˆ›å»ºæ¼”ç¤ºæ–‡ç¨¿...")
                  start_result = await client.call_tool("start_presentation", {
                      "session_id": session_id,
                      "prompt": "Create a presentation about quantum computing and its applications in cryptography",
                      "n_slides": 5,
                      "language": "English"
                  })
                  
                  if start_result.data.get("status") != "success":
                      raise Exception(f"æ­¥éª¤1å¤±è´¥: {start_result.data}")
                  
                  print("âœ… æ¼”ç¤ºæ–‡ç¨¿ä¼šè¯åˆ›å»ºæˆåŠŸ")
                  
                  # æ­¥éª¤2: ç”Ÿæˆå¤§çº²
                  print("\nğŸ“‹ æ­¥éª¤2: ç”Ÿæˆå¤§çº²...")
                  outline_result = await client.call_tool("continue_workflow", {
                      "session_id": session_id
                  })
                  
                  if outline_result.data.get("status") != "success":
                      raise Exception(f"æ­¥éª¤2å¤±è´¥: {outline_result.data}")
                  
                  print("âœ… å¤§çº²ç”ŸæˆæˆåŠŸ")
                  title = outline_result.data.get("title", "")
                  print(f"   æ ‡é¢˜: {title}")
                  
                  # æ­¥éª¤3: ç»§ç»­åˆ°å¸ƒå±€é€‰æ‹©é˜¶æ®µ
                  print("\nğŸ”„ æ­¥éª¤3: è¿›å…¥å¸ƒå±€é€‰æ‹©é˜¶æ®µ...")
                  layout_stage_result = await client.call_tool("continue_workflow", {
                      "session_id": session_id
                  })
                  
                  print(f"å¸ƒå±€é˜¶æ®µçŠ¶æ€: {layout_stage_result.data.get('status')}")
                  print(f"å¸ƒå±€é˜¶æ®µæ¶ˆæ¯: {layout_stage_result.data.get('message', '')}")
                  
                  # æ­¥éª¤4: é€‰æ‹©å¸ƒå±€
                  print("\nğŸ¨ æ­¥éª¤4: é€‰æ‹©å¸ƒå±€...")
                  choose_result = await client.call_tool("choose_layout", {
                      "session_id": session_id,
                      "layout_name": "classic"
                  })
                  
                  print(f"å¸ƒå±€é€‰æ‹©çŠ¶æ€: {choose_result.data.get('status')}")
                  print(f"å¸ƒå±€é€‰æ‹©æ¶ˆæ¯: {choose_result.data.get('message', '')}")
                  
                  # æ­¥éª¤5: æœ€ç»ˆç”Ÿæˆ
                  print("\nğŸ”„ æ­¥éª¤5: æœ€ç»ˆç”ŸæˆPPT...")
                  final_result = await client.call_tool("continue_workflow", {
                      "session_id": session_id
                  })

                  print(f"æœ€ç»ˆç”ŸæˆçŠ¶æ€: {final_result.data.get('status')}")
                  print(f"æœ€ç»ˆç”Ÿæˆæ¶ˆæ¯: {final_result.data.get('message', '')}")

                  # ç›´æ¥è¿›å…¥å¯¼å‡ºæ­¥éª¤ï¼Œä¸ä¾èµ–presentation_id
                  # æ­¥éª¤6: å¯¼å‡ºPPTæ–‡ä»¶
                  print("\nğŸ“¤ æ­¥éª¤6: å¯¼å‡ºPPTæ–‡ä»¶...")
                  export_result = await client.call_tool("export_presentation", {
                      "session_id": session_id,
                      "format": "pptx"  # æ ¹æ®MCPå·¥å…·æè¿°ï¼Œå®é™…åº”ä¸º"ppc"æˆ–"pdf"ï¼Œä½†æµ‹è¯•ä½¿ç”¨"pptx"
                  })

                  print(f"å¯¼å‡ºçŠ¶æ€: {export_result.data.get('status')}")
                  print(f"å¯¼å‡ºæ¶ˆæ¯: {export_result.data.get('message', '')}")

                  if export_result.data.get("status") == "success":
                      server_file_path = export_result.data.get("path")

                      if server_file_path:
                          print(f"\nğŸ“ æ‰¾åˆ°æ–‡ä»¶è·¯å¾„: {server_file_path}")

                          # æ„å»ºä¸‹è½½URL
                          filename = os.path.basename(server_file_path)
                          download_url = f"http://192.168.1.218:4999/app_data/exports/{filename}"

                          print(f"ğŸ“¥ ä¸‹è½½URL: {download_url}")

                          # ä¸‹è½½æ–‡ä»¶
                          print("ğŸ“¥ ä¸‹è½½PPTæ–‡ä»¶...")
                          local_filename = f"mcp_fixed_{datetime.now().strftime('%Y%m%d_%H%M%S')}.pptx"
                          local_path = os.path.join(os.getcwd(), local_filename)

                          async with aiohttp.ClientSession() as session:
                              async with session.get(download_url) as response:
                                  if response.status == 200:
                                      with open(local_path, 'wb') as f:
                                          async for chunk in response.content.iter_chunked(8192):
                                              f.write(chunk)

                                      file_size = os.path.getsize(local_path)
                                      print(f"âœ… MCPä¿®å¤éªŒè¯æˆåŠŸ!")
                                      print(f"   ğŸ“ æœ¬åœ°æ–‡ä»¶: {local_path}")
                                      print(f"   ğŸ“ æ–‡ä»¶å¤§å°: {file_size} å­—èŠ‚")
                                      print(f"   ğŸŒ æœåŠ¡å™¨è·¯å¾„: {server_file_path}")

                                      return {
                                          "success": True,
                                          "local_path": local_path,
                                          "file_size": file_size,
                                          "server_path": server_file_path,
                                          "fix_verified": True
                                      }
                                  else:
                                      error_text = await response.text()
                                      raise Exception(f"ä¸‹è½½å¤±è´¥: {response.status} - {error_text}")
                      else:
                          print("âš ï¸ å¯¼å‡ºæˆåŠŸä½†æ²¡æœ‰è¿”å›æ–‡ä»¶è·¯å¾„")
                          return {
                              "success": True,
                              "fix_verified": True,
                              "message": "å¯¼å‡ºæˆåŠŸä½†æ— æ–‡ä»¶è·¯å¾„",
                              "export_status": export_result.data
                          }
                  else:
                      print(f"âŒ å¯¼å‡ºå¤±è´¥: {export_result.data}")
                      return {
                          "success": False,
                          "fix_verified": False,
                          "error": f"å¯¼å‡ºå¤±è´¥: {export_result.data}"
                      }
                  
          except Exception as e:
              print(f"âŒ MCPä¿®å¤æµ‹è¯•å¤±è´¥: {str(e)}")
              return {
                  "success": False,
                  "fix_verified": False,
                  "error": str(e)
              }

      async def main():
          """ä¸»å‡½æ•°"""
          print("ğŸš€ MCPä¿®å¤éªŒè¯æµ‹è¯•\n")
          
          result = await test_mcp_fixed_workflow()
          
          print("\n" + "=" * 60)
          print("ğŸ“‹ MCPä¿®å¤éªŒè¯ç»“æœ")
          print("=" * 60)
          
          if result["success"]:
              if result.get("local_path"):
                  print("ğŸ‰ MCPä¿®å¤éªŒè¯å®Œå…¨æˆåŠŸ!")
                  print(f"   ğŸ“ æœ¬åœ°æ–‡ä»¶: {result['local_path']}")
                  print(f"   ğŸ“ æ–‡ä»¶å¤§å°: {result['file_size']} å­—èŠ‚")
                  if result.get("server_path"):
                      print(f"   ğŸŒ æœåŠ¡å™¨è·¯å¾„: {result['server_path']}")
              else:
                  print("âœ… MCPä¿®å¤éªŒè¯æˆåŠŸï¼ˆå·¥ä½œæµç¨‹æ­£å¸¸ï¼‰")
                  print(f"   æ¶ˆæ¯: {result.get('message', '')}")

              print(f"\nğŸ”§ ä¿®å¤çŠ¶æ€: âœ… å·²ä¿®å¤")
              print(f"   - å®Œæ•´æ‰§è¡ŒMCPå·¥ä½œæµç¨‹")
              print(f"   - æˆåŠŸé€šè¿‡export_presentationè·å–æ–‡ä»¶è·¯å¾„")
              print(f"   - æ–‡æ¡£å¯¼å‡ºåŠŸèƒ½æ­£å¸¸")
              print(f"   - æ–‡ä»¶ä¸‹è½½åŠŸèƒ½æ­£å¸¸")

          else:
              print(f"âŒ MCPä¿®å¤éªŒè¯å¤±è´¥: {result['error']}")
              print(f"ğŸ”§ ä¿®å¤çŠ¶æ€: âŒ ä¿®å¤å¤±è´¥")

      if __name__ == "__main__":
          asyncio.run(main())
mcp_url:  "http://192.168.1.218:4995/mcp"
base_url: "http://192.168.1.218:4999"
endpoints:
  - summary: "ä¸Šä¼ æ–‡ä»¶"
    method: "POST"
    path: "/api/v1/ppt/files/upload"
    inputs:
      type: "object"
      properties:
        files:
          type: "array"
          items:
            type: "string"
            format: "binary"
          description: "ä¸Šä¼ çš„æ–‡ä»¶åˆ—è¡¨"
    outputs:
      success_schema:
        type: "array"
        items:
          type: "string"
        description: "ä¸Šä¼ æˆåŠŸçš„æ–‡ä»¶è·¯å¾„åˆ—è¡¨"

  - summary: "åˆ†è§£æ–‡ä»¶"
    method: "POST"
    path: "/api/v1/ppt/files/decompose"
    inputs:
      type: "object"
      properties:
        file_paths:
          type: "array"
          items:
            type: "string"
          description: "éœ€è¦åˆ†è§£çš„æ–‡ä»¶è·¯å¾„åˆ—è¡¨"
    outputs:
      success_schema:
        type: "array"
        items:
          $ref: "#/components/schemas/DecomposedFileInfo"
        description: "åˆ†è§£åçš„æ–‡ä»¶ä¿¡æ¯"

  - summary: "ç”Ÿæˆæ¼”ç¤ºæ–‡ç¨¿"
    method: "POST"
    path: "/api/v1/ppt/presentation/generate"
    inputs:
      type: "object"
      properties:
        prompt:
          type: "string"
          description: "ç”Ÿæˆæ¼”ç¤ºæ–‡ç¨¿çš„æç¤ºæ–‡æœ¬"
        n_slides:
          type: "integer"
          description: "å¹»ç¯ç‰‡æ•°é‡"
          default: 8
        language:
          type: "string"
          description: "è¯­è¨€"
          default: "English"
        template:
          type: "string"
          description: "æ¨¡æ¿åç§°"
          default: "general"
        files:
          type: "array"
          items:
            type: "string"
            format: "binary"
          description: "å¯é€‰çš„ä¸Šä¼ æ–‡ä»¶"
        export_as:
          type: "string"
          enum: ["pptx", "pdf"]
          description: "å¯¼å‡ºæ ¼å¼"
          default: "pptx"
      required: ["prompt"]
    outputs:
      success_schema:
        $ref: "#/components/schemas/PresentationPathAndEditPath"

  - summary: "å¯¼å‡ºPPTXæ–‡ä»¶"
    method: "POST"
    path: "/api/v1/ppt/presentation/export/pptx"
    inputs:
      type: "object"
      properties:
        name:
          type: "string"
          description: "æ¼”ç¤ºæ–‡ç¨¿åç§°"
        slides:
          type: "array"
          items:
            $ref: "#/components/schemas/PptxSlideModel"
          description: "å¹»ç¯ç‰‡åˆ—è¡¨"
        shapes:
          type: "array"
          items:
            $ref: "#/components/schemas/PptxShapeModel"
          description: "å½¢çŠ¶åˆ—è¡¨"
      required: ["slides"]
    outputs:
      success_schema:
        type: "string"
        format: "binary"
        description: "ç”Ÿæˆçš„PPTXæ–‡ä»¶å†…å®¹"

  - summary: "ä¸Šä¼ å­—ä½“"
    method: "POST"
    path: "/api/v1/ppt/fonts/upload"
    inputs:
      type: "object"
      properties:
        font_file:
          type: "string"
          format: "binary"
          description: "å­—ä½“æ–‡ä»¶(.ttf, .otf, .woff, .woff2, .eot)"
      required: ["font_file"]
    outputs:
      success_schema:
        $ref: "#/components/schemas/FontUploadResponse"

  - summary: "åˆ—å‡ºå­—ä½“"
    method: "GET"
    path: "/api/v1/ppt/fonts/list"
    outputs:
      success_schema:
        $ref: "#/components/schemas/FontListResponse"

  - summary: "åˆ é™¤å­—ä½“"
    method: "DELETE"
    path: "/api/v1/ppt/fonts/delete/{filename}"
    inputs:
      parameters:
        - name: "filename"
          in: "path"
          type: "string"
          description: "è¦åˆ é™¤çš„å­—ä½“æ–‡ä»¶å"
          required: true
    outputs:
      success_schema:
        type: "object"

  - summary: "å¤„ç†PPTXå¹»ç¯ç‰‡"
    method: "POST"
    path: "/api/v1/ppt/pptx-slides/process"
    inputs:
      type: "object"
      properties:
        pptx_file:
          type: "string"
          format: "binary"
          description: "PPTXæ–‡ä»¶"
        fonts:
          type: "array"
          items:
            type: "string"
            format: "binary"
          description: "å¯é€‰å­—ä½“æ–‡ä»¶"
      required: ["pptx_file"]
    outputs:
      success_schema:
        $ref: "#/components/schemas/PptxSlidesResponse"

  - summary: "è½¬æ¢å¹»ç¯ç‰‡ä¸ºHTML"
    method: "POST"
    path: "/api/v1/ppt/slide-to-html/"
    inputs:
      type: "object"
      properties:
        image:
          type: "string"
          description: "å¹»ç¯ç‰‡å›¾åƒè·¯å¾„"
        xml:
          type: "string"
          description: "å¹»ç¯ç‰‡XMLå†…å®¹"
        fonts:
          type: "array"
          items:
            type: "string"
          description: "ä½¿ç”¨çš„å­—ä½“åˆ—è¡¨"
      required: ["image", "xml"]
    outputs:
      success_schema:
        $ref: "#/components/schemas/SlideToHtmlResponse"

  - summary: "è½¬æ¢HTMLä¸ºReactç»„ä»¶"
    method: "POST"
    path: "/api/v1/ppt/html-to-react/"
    inputs:
      type: "object"
      properties:
        html:
          type: "string"
          description: "HTMLå†…å®¹"
        image:
          type: "string"
          description: "ç›¸å…³å›¾åƒè·¯å¾„"
      required: ["html"]
    outputs:
      success_schema:
        $ref: "#/components/schemas/HtmlToReactResponse"

  - summary: "ç¼–è¾‘å¸¦å›¾åƒçš„HTML"
    method: "POST"
    path: "/api/v1/ppt/html-edit/"
    inputs:
      type: "object"
      properties:
        current_ui_image:
          type: "string"
          format: "binary"
          description: "å½“å‰UIå›¾åƒ"
        sketch_image:
          type: "string"
          format: "binary"
          description: "è‰å›¾å›¾åƒï¼ˆå¯é€‰ï¼‰"
        html:
          type: "string"
          description: "è¦ç¼–è¾‘çš„HTMLå†…å®¹"
        prompt:
          type: "string"
          description: "ç¼–è¾‘æç¤º"
      required: ["current_ui_image", "html", "prompt"]
    outputs:
      success_schema:
        $ref: "#/components/schemas/HtmlEditResponse"

  - summary: "è·å–æ‰€æœ‰æ¼”ç¤ºæ–‡ç¨¿"
    method: "GET"
    path: "/api/v1/ppt/presentation/all"
    outputs:
      success_schema:
        type: "array"
        items:
          $ref: "#/components/schemas/PresentationWithSlides-Output"
        description: "æ‰€æœ‰æ¼”ç¤ºæ–‡ç¨¿åˆ—è¡¨"

  - summary: "åˆ é™¤æ¼”ç¤ºæ–‡ç¨¿"
    method: "DELETE"
    path: "/api/v1/ppt/presentation"
    inputs:
      parameters:
        - name: "id"
          in: "query"
          type: "string"
          description: "æ¼”ç¤ºæ–‡ç¨¿ID"
          required: true
    outputs:
      success_schema:
        type: "object"

  - summary: "åˆ›å»ºæ¼”ç¤ºæ–‡ç¨¿"
    method: "POST"
    path: "/api/v1/ppt/presentation/create"
    inputs:
      type: "object"
      properties:
        prompt:
          type: "string"
          description: "ç”Ÿæˆæç¤º"
        n_slides:
          type: "integer"
          description: "å¹»ç¯ç‰‡æ•°é‡"
        language:
          type: "string"
          description: "è¯­è¨€"
        file_paths:
          type: "array"
          items:
            type: "string"
          description: "æ–‡ä»¶è·¯å¾„åˆ—è¡¨"
      required: ["prompt", "n_slides", "language"]
    outputs:
      success_schema:
        $ref: "#/components/schemas/PresentationModel"

  - summary: "æ›´æ–°æ¼”ç¤ºæ–‡ç¨¿"
    method: "PUT"
    path: "/api/v1/ppt/presentation/update"
    inputs:
      type: "object"
      properties:
        $ref: "#/components/schemas/PresentationWithSlides-Input"
      required: true
    outputs:
      success_schema:
        $ref: "#/components/schemas/PresentationWithSlides-Output"

  - summary: "å¤„ç†PDFå¹»ç¯ç‰‡"
    method: "POST"
    path: "/api/v1/ppt/pdf-slides/process"
    inputs:
      type: "object"
      properties:
        pdf_file:
          type: "string"
          format: "binary"
          description: "PDFæ–‡ä»¶"
      required: ["pdf_file"]
    outputs:
      success_schema:
        $ref: "#/components/schemas/PdfSlidesResponse"

  - summary: "åˆ†æPPTXå­—ä½“"
    method: "POST"
    path: "/api/v1/ppt/pptx-fonts/process"
    inputs:
      type: "object"
      properties:
        pptx_file:
          type: "string"
          format: "binary"
          description: "PPTXæ–‡ä»¶"
      required: ["pptx_file"]
    outputs:
      success_schema:
        $ref: "#/components/schemas/PptxFontsResponse"

components:
  schemas:
    DecomposedFileInfo:
      type: "object"
      properties:
        name: 
          type: "string"
        file_path: 
          type: "string"
      required: ["name", "file_path"]

    PresentationPathAndEditPath:
      type: "object"
      properties:
        presentation_id: 
          type: "string"
        path: 
          type: "string"
        edit_path: 
          type: "string"
      required: ["presentation_id", "path", "edit_path"]

    FontUploadResponse:
      type: "object"
      properties:
        success: 
          type: "boolean"
        font_name: 
          type: "string"
        font_url: 
          type: "string"
        font_path: 
          type: "string"
        message: 
          type: "string"
      required: ["success", "font_name", "font_url", "font_path"]

    FontListResponse:
      type: "object"
      properties:
        success: 
          type: "boolean"
        fonts: 
          type: "array"
          items: 
            type: "object"
        message: 
          type: "string"
      required: ["success", "fonts"]

    PptxSlideModel:
      type: "object"
      properties:
        background: 
          $ref: "#/components/schemas/PptxFillModel"
        note: 
          type: "string"
        shapes: 
          type: "array"
          items: 
            anyOf:
              - $ref: "#/components/schemas/PptxTextBoxModel"
              - $ref: "#/components/schemas/PptxAutoShapeBoxModel"
              - $ref: "#/components/schemas/PptxConnectorModel"
              - $ref: "#/components/schemas/PptxPictureBoxModel"
      required: ["shapes"]

    PptxShapeModel:
      type: "object"
      properties:
        shape_type: 
          type: "string"
          enum: ["textbox", "autoshape", "picture", "connector"]
      required: ["shape_type"]

    PptxFillModel:
      type: "object"
      properties:
        color: 
          type: "string"
        opacity: 
          type: "number"
          default: 1.0
      required: ["color"]

    PptxTextBoxModel:
      type: "object"
      properties:
        shape_type: 
          type: "string"
          default: "textbox"
        margin: 
          $ref: "#/components/schemas/PptxSpacingModel"
        fill: 
          $ref: "#/components/schemas/PptxFillModel"
        position: 
          $ref: "#/components/schemas/PptxPositionModel"
        text_wrap: 
          type: "boolean"
          default: true
        paragraphs: 
          type: "array"
          items: 
            $ref: "#/components/schemas/PptxParagraphModel"
      required: ["position", "paragraphs"]

    PptxPositionModel:
      type: "object"
      properties:
        left: 
          type: "integer"
          default: 0
        top: 
          type: "integer"
          default: 0
        width: 
          type: "integer"
          default: 0
        height: 
          type: "integer"
          default: 0

    PptxSpacingModel:
      type: "object"
      properties:
        top: 
          type: "integer"
          default: 0
        bottom: 
          type: "integer"
          default: 0
        left: 
          type: "integer"
          default: 0
        right: 
          type: "integer"
          default: 0

    PptxParagraphModel:
      type: "object"
      properties:
        spacing: 
          $ref: "#/components/schemas/PptxSpacingModel"
        alignment: 
          $ref: "#/components/schemas/PP_PARAGRAPH_ALIGNMENT"
        font: 
          $ref: "#/components/schemas/PptxFontModel"
        line_height: 
          type: "number"
        text: 
          type: "string"
        text_runs: 
          type: "array"
          items: 
            $ref: "#/components/schemas/PptxTextRunModel"

    PP_PARAGRAPH_ALIGNMENT:
      type: "integer"
      enum: [2, 5, 4, 7, 1, 3, 6, -2]
      description: "æ®µè½å¯¹é½æ–¹å¼"

    PptxFontModel:
      type: "object"
      properties:
        name: 
          type: "string"
          default: "Inter"
        size: 
          type: "integer"
          default: 16
        italic: 
          type: "boolean"
          default: false
        color: 
          type: "string"
          default: "000000"
        font_weight: 
          type: "integer"
          default: 400
        underline: 
          type: "boolean"
        strike: 
          type: "boolean"

    PptxTextRunModel:
      type: "object"
      properties:
        text: 
          type: "string"
        font: 
          $ref: "#/components/schemas/PptxFontModel"
      required: ["text"]

    PptxAutoShapeBoxModel:
      type: "object"
      properties:
        shape_type: 
          type: "string"
          default: "autoshape"
        type: 
          $ref: "#/components/schemas/MSO_AUTO_SHAPE_TYPE"
          default: 1
        margin: 
          $ref: "#/components/schemas/PptxSpacingModel"
        fill: 
          $ref: "#/components/schemas/PptxFillModel"
        stroke: 
          $ref: "#/components/schemas/PptxStrokeModel"
        shadow: 
          $ref: "#/components/schemas/PptxShadowModel"
        position: 
          $ref: "#/components/schemas/PptxPositionModel"
        text_wrap: 
          type: "boolean"
          default: true
        border_radius: 
          type: "integer"
        paragraphs: 
          type: "array"
          items: 
            $ref: "#/components/schemas/PptxParagraphModel"
      required: ["position"]

    MSO_AUTO_SHAPE_TYPE:
      type: "integer"
      enum: [129,131,125,134,132,130,127,126,128,136,133,135,25,137,41,44,15,20,13,182,181,180,52,161,60,179,108,162,169,11,14,48,100,46,45,47,99,144,141,4,146,18,27,26,104,36,56,98,89,90,62,75,79,73,64,63,84,87,88,67,81,66,86,71,72,82,68,139,74,78,65,70,61,76,85,80,83,77,69,16,158,174,172,173,159,21,145,10,102,7,34,54,31,29,176,37,57,177,140,40,43,22,109,113,121,117,110,114,122,118,111,115,123,119,112,116,124,120,183,166,167,164,165,168,163,24,143,50,19,6,9,107,2,51,142,175,28,171,39,59,1,105,12,33,53,32,30,8,5,106,151,153,152,17,155,157,156,154,170,149,150,94,95,96,91,92,147,148,93,49,23,178,160,3,35,55,38,58,97,42,101,103]

    PptxStrokeModel:
      type: "object"
      properties:
        color: 
          type: "string"
        thickness: 
          type: "number"
        opacity: 
          type: "number"
          default: 1.0
      required: ["color", "thickness"]

    PptxShadowModel:
      type: "object"
      properties:
        radius: 
          type: "integer"
        offset: 
          type: "integer"
          default: 0
        color: 
          type: "string"
          default: "000000"
        opacity: 
          type: "number"
          default: 0.5
        angle: 
          type: "integer"
          default: 0
      required: ["radius"]

    PptxPictureBoxModel:
      type: "object"
      properties:
        shape_type: 
          type: "string"
          default: "picture"
        position: 
          $ref: "#/components/schemas/PptxPositionModel"
        margin: 
          $ref: "#/components/schemas/PptxSpacingModel"
        clip: 
          type: "boolean"
          default: true
        opacity: 
          type: "number"
        invert: 
          type: "boolean"
          default: false
        border_radius: 
          type: "array"
          items: 
            type: "integer"
        shape: 
          $ref: "#/components/schemas/PptxBoxShapeEnum"
        object_fit: 
          $ref: "#/components/schemas/PptxObjectFitModel"
        picture: 
          $ref: "#/components/schemas/PptxPictureModel"
      required: ["position", "picture"]

    PptxBoxShapeEnum:
      type: "string"
      enum: ["rectangle", "circle"]

    PptxObjectFitModel:
      type: "object"
      properties:
        fit: 
          $ref: "#/components/schemas/PptxObjectFitEnum"
        focus: 
          type: "array"
          items: 
            type: "number"
          minItems: 2
          maxItems: 2

    PptxObjectFitEnum:
      type: "string"
      enum: ["contain", "cover", "fill"]

    PptxPictureModel:
      type: "object"
      properties:
        is_network: 
          type: "boolean"
        path: 
          type: "string"
      required: ["is_network", "path"]

    PptxConnectorModel:
      type: "object"
      properties:
        shape_type: 
          type: "string"
          default: "connector"
        type: 
          $ref: "#/components/schemas/MSO_CONNECTOR_TYPE"
          default: 1
        position: 
          $ref: "#/components/schemas/PptxPositionModel"
        thickness: 
          type: "number"
          default: 0.5
        color: 
          type: "string"
          default: "000000"
        opacity: 
          type: "number"
          default: 1.0
      required: ["position"]

    MSO_CONNECTOR_TYPE:
      type: "integer"
      enum: [3,2,1,-2]

    PptxSlidesResponse:
      type: "object"
      properties:
        success: 
          type: "boolean"
        slides: 
          type: "array"
          items: 
            $ref: "#/components/schemas/SlideData"
        total_slides: 
          type: "integer"
        fonts: 
          $ref: "#/components/schemas/FontAnalysisResult"
      required: ["success", "slides", "total_slides"]

    SlideData:
      type: "object"
      properties:
        slide_number: 
          type: "integer"
        screenshot_url: 
          type: "string"
        xml_content: 
          type: "string"
        normalized_fonts: 
          type: "array"
          items: 
            type: "string"
      required: ["slide_number", "screenshot_url", "xml_content", "normalized_fonts"]

    FontAnalysisResult:
      type: "object"
      properties:
        internally_supported_fonts: 
          type: "array"
          items: 
            type: "object"
        not_supported_fonts: 
          type: "array"
          items: 
            type: "string"
      required: ["internally_supported_fonts", "not_supported_fonts"]

    SlideToHtmlResponse:
      type: "object"
      properties:
        success: 
          type: "boolean"
        html: 
          type: "string"
      required: ["success", "html"]

    HtmlToReactResponse:
      type: "object"
      properties:
        success: 
          type: "boolean"
        react_component: 
          type: "string"
        message: 
          type: "string"
      required: ["success", "react_component"]

    HtmlEditResponse:
      type: "object"
      properties:
        success: 
          type: "boolean"
        edited_html: 
          type: "string"
        message: 
          type: "string"
      required: ["success", "edited_html"]

    PresentationModel:
      type: "object"
      properties:
        id: 
          type: "string"
        prompt: 
          type: "string"
        n_slides: 
          type: "integer"
        language: 
          type: "string"
        title: 
          type: "string"
        file_paths: 
          type: "array"
          items: 
            type: "string"
        outlines: 
          type: "object"
        created_at: 
          type: "string"
          format: "date-time"
        updated_at: 
          type: "string"
          format: "date-time"
        layout: 
          type: "object"
        structure: 
          type: "object"
      required: ["id", "prompt", "n_slides", "language", "created_at", "updated_at"]

    PresentationWithSlides-Input:
      type: "object"
      properties:
        id: 
          type: "string"
        prompt: 
          type: "string"
        n_slides: 
          type: "integer"
        language: 
          type: "string"
        title: 
          type: "string"
        outlines: 
          $ref: "#/components/schemas/PresentationOutlineModel"
        created_at: 
          type: "string"
          format: "date-time"
        updated_at: 
          type: "string"
          format: "date-time"
        layout: 
          $ref: "#/components/schemas/PresentationLayoutModel"
        structure: 
          $ref: "#/components/schemas/PresentationStructureModel"
        slides: 
          type: "array"
          items: 
            $ref: "#/components/schemas/SlideModel"
      required: ["id", "prompt", "n_slides", "language", "outlines", "created_at", "updated_at", "layout", "structure", "slides"]

    PresentationWithSlides-Output:
      type: "object"
      properties:
        id: 
          type: "string"
        prompt: 
          type: "string"
        n_slides: 
          type: "integer"
        language: 
          type: "string"
        title: 
          type: "string"
        outlines: 
          $ref: "#/components/schemas/PresentationOutlineModel"
        created_at: 
          type: "string"
          format: "date-time"
        updated_at: 
          type: "string"
          format: "date-time"
        layout: 
          $ref: "#/components/schemas/PresentationLayoutModel"
        structure: 
          $ref: "#/components/schemas/PresentationStructureModel"
        slides: 
          type: "array"
          items: 
            $ref: "#/components/schemas/SlideModel"
      required: ["id", "prompt", "n_slides", "language", "outlines", "created_at", "updated_at", "layout", "structure", "slides"]

    PresentationOutlineModel:
      type: "object"
      properties:
        slides: 
          type: "array"
          items: 
            $ref: "#/components/schemas/SlideOutlineModel"
      required: ["slides"]

    SlideOutlineModel:
      type: "object"
      properties:
        content: 
          type: "string"
      required: ["content"]

    PresentationLayoutModel:
      type: "object"
      properties:
        name: 
          type: "string"
        ordered: 
          type: "boolean"
          default: false
        slides: 
          type: "array"
          items: 
            $ref: "#/components/schemas/SlideLayoutModel"
      required: ["name", "slides"]

    SlideLayoutModel:
      type: "object"
      properties:
        id: 
          type: "string"
        name: 
          type: "string"
        description: 
          type: "string"
        json_schema: 
          type: "object"
      required: ["id", "json_schema"]

    PresentationStructureModel:
      type: "object"
      properties:
        slides: 
          type: "array"
          items: 
            type: "integer"
          description: "å¹»ç¯ç‰‡å¸ƒå±€ç´¢å¼•åˆ—è¡¨"
      required: ["slides"]

    SlideModel:
      type: "object"
      properties:
        id: 
          type: "string"
        presentation: 
          type: "string"
        layout_group: 
          type: "string"
        layout: 
          type: "string"
        index: 
          type: "integer"
        content: 
          type: "object"
        html_content: 
          type: "string"
        speaker_note: 
          type: "string"
        properties: 
          type: "object"
      required: ["presentation", "layout_group", "layout", "index", "content", "html_content", "properties"]

    PdfSlidesResponse:
      type: "object"
      properties:
        success: 
          type: "boolean"
        slides: 
          type: "array"
          items: 
            $ref: "#/components/schemas/PdfSlideData"
        total_slides: 
          type: "integer"
      required: ["success", "slides", "total_slides"]

    PdfSlideData:
      type: "object"
      properties:
        slide_number: 
          type: "integer"
        screenshot_url: 
          type: "string"
      required: ["slide_number", "screenshot_url"]

    PptxFontsResponse:
      type: "object"
      properties:
        success: 
          type: "boolean"
        fonts: 
          $ref: "#/components/schemas/FontAnalysisResult"
      required: ["success", "fonts"]

    ErrorResponse:
      type: "object"
      properties:
        success: 
          type: "boolean"
          default: false
        detail: 
          type: "string"
        error_code: 
          type: "string"
      required: ["detail"]

    ValidationError:
      type: "object"
      properties:
        loc: 
          type: "array"
          items: 
            anyOf:
              - type: "string"
              - type: "integer"
        msg: 
          type: "string"
        type: 
          type: "string"
      required: ["loc", "msg", "type"]

    HTTPValidationError:
      type: "object"
      properties:
        detail: 
          type: "array"
          items: 
            $ref: "#/components/schemas/ValidationError"
